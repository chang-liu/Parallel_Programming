<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:openmp.2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><object type="{0C55C096-0F1D-4F28-AAA2-85EF591126E7}" cotype="cs" id="cosymantecbfw" style="width: 0px; height: 0px; display: block;"></object><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>
    randal:teach:cs420:openmp.2012    [HSSL Wiki]
  </title>

  <meta name="generator" content="DokuWiki">
<meta name="robots" content="index,follow">
<meta name="date" content="2012-02-10T17:01:47-0500">
<meta name="keywords" content="randal,teach,cs420,openmp.2012">
<link rel="search" type="application/opensearchdescription+xml" href="http://hssl.cs.jhu.edu/wiki/lib/exe/opensearch.php" title="HSSL Wiki">
<link rel="start" href="http://hssl.cs.jhu.edu/wiki/">
<link rel="contents" href="http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:openmp.2012&do=index" title="Sitemap">
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="http://hssl.cs.jhu.edu/wiki/feed.php">
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://hssl.cs.jhu.edu/wiki/feed.php?mode=list&ns=randal:teach:cs420">
<link rel="alternate" type="text/html" title="Plain HTML" href="http://hssl.cs.jhu.edu/wiki/doku.php?do=export_xhtml&id=randal:teach:cs420:openmp.2012">
<link rel="alternate" type="text/plain" title="Wiki Markup" href="http://hssl.cs.jhu.edu/wiki/doku.php?do=export_raw&id=randal:teach:cs420:openmp.2012">
<link rel="canonical" href="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/randal teach cs420 openmp.2012 [HSSL Wiki].htm">
<link rel="stylesheet" media="screen" type="text/css" href="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/css.php">
<link rel="stylesheet" media="all" type="text/css" href="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/css(1).php">
<link rel="stylesheet" media="print" type="text/css" href="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/css(2).php">
<script type="text/javascript"><!--//--><![CDATA[//><!--
var NS='randal:teach:cs420';var JSINFO = {"id":"randal:teach:cs420:openmp.2012","namespace":"randal:teach:cs420"};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/js.php"></script>

  <link rel="shortcut icon" href="http://hssl.cs.jhu.edu/wiki/lib/tpl/default/images/favicon.ico">

  </head>

<body class=" hasGoogleVoiceExt">
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:openmp.2012&do=backlink" title="Backlinks">randal:teach:cs420:openmp.2012</a>]]
      </div>
      <div class="logo">
        <a href="http://hssl.cs.jhu.edu/wiki/doku.php" name="dokuwiki__top" id="dokuwiki__top" accesskey="h" title="[H]">HSSL Wiki</a>      </div>

      <div class="clearer"></div>
    </div>

    
    <div class="bar" id="bar__top">
      <div class="bar-left" id="bar__topleft">
        <form class="button btn_source" method="post" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="edit"><input type="hidden" name="rev" value=""><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Show pagesource" class="button" accesskey="v" title="Show pagesource [V]"></div></form>        <form class="button btn_revs" method="get" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="revisions"><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Old revisions" class="button" accesskey="o" title="Old revisions [O]"></div></form>      </div>

      <div class="bar-right" id="bar__topright">
        <form class="button btn_recent" method="get" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="recent"><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Recent changes" class="button" accesskey="r" title="Recent changes [R]"></div></form>        <form action="http://hssl.cs.jhu.edu/wiki/doku.php" accept-charset="utf-8" class="search" id="dw__search" method="get"><div class="no"><input type="hidden" name="do" value="search"><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]"><input type="submit" value="Search" class="button" title="Search"><div id="qsearch__out" class="ajax_qsearch JSpopup" style="display: none; "></div></div></form>&nbsp;
      </div>

      <div class="clearer"></div>
    </div>

        <div class="breadcrumbs">
      <span class="bchead">Trace:</span> <span class="bcsep">»</span> <a href="http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:2012_course_schedule_and_assignments" class="breadcrumbs" title="randal:teach:cs420:2012_course_schedule_and_assignments">2012_course_schedule_and_assignments</a> <span class="bcsep">»</span> <a href="http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:programming_assignment" class="breadcrumbs" title="randal:teach:cs420:programming_assignment">programming_assignment</a> <span class="bcsep">»</span> <span class="curid"><a href="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/randal teach cs420 openmp.2012 [HSSL Wiki].htm" class="breadcrumbs" title="randal:teach:cs420:openmp.2012">openmp.2012</a></span>          </div>
    
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    
<h3 class="sectionedit1"><a name="programming_assignment_1parallelizing_file_compression_with_openmp" id="programming_assignment_1parallelizing_file_compression_with_openmp">Programming Assignment #1: Parallelizing File Compression with OpenMP</a></h3>
<div class="level3">

<p>

Due date: Thursday 16 February at 11:59 pm (end of day)
</p>

<p>
OpenMP offers one of the simplest ways to parallelize existing serial programs
based on using compiler directives to run existing codes in parallel.
This first assignment explores exactly that topic.
</p>

</div>

<h4><a name="i_give_you" id="i_give_you">I give you</a></h4>
<div class="level4">

<p>

A serial program that compresses a directory hierarchy.
The program takes an input directory and output directory.

</p>
<pre class="code">&gt; ./serialcompress 
Usage: compresstree inputdir outputdir
 inputdir must exist
 outputdir cannot exist</pre>

<p>

So, when you follow instructions:

</p>
<pre class="code">&gt; ./serialcompress /home/randal/cs420jhu/ /tmp/compressdir</pre>

<p>
You get a bunch of output and a directory hierarchy in /tmp/compressdir that matches that of the source dir, but has every regular file gzipped.  E.g.

</p>
<pre class="code">&gt; ls /tmp/compressdir/
ompcompress  README.gz</pre>

<p>

The source code is available at the class' GitHub site <a href="https://github.com/randalburns/cs420jhu/" class="urlextern" title="https://github.com/randalburns/cs420jhu/" rel="nofollow">https://github.com/randalburns/cs420jhu/</a>.  You can use
git to get the source, which I highly recommend because git is a cool tool and getting to know git will benefit you in the future.  This is not a requirement.  You can just download the files if you don't want to go there.
</p>

</div>

<h4><a name="you_implement" id="you_implement">You implement</a></h4>
<div class="level4">

<p>

A parallel version of this code that uses up to eight threads to compress different portions of the directory tree in parallel.  For example, a directory with eight sub-directories:

</p>
<pre class="code">&gt; ls /tmp/example
a  b  c  d  e  f  g  h</pre>

<p>

runs in eight different threads.

</p>
<pre class="code">&gt; a.out /tmp/example/ /tmp/other
OMP Thread 1 Directory/File b
OMP Thread 2 Directory/File c
OMP Thread 7 Directory/File h
OMP Thread 3 Directory/File d
OMP Thread 0 Directory/File a
OMP Thread 6 Directory/File g
OMP Thread 5 Directory/File f
OMP Thread 4 Directory/File e</pre>

<p>

This is the output from implementation which based on the following print statement.

</p>
<pre class="code">printf ( "OMP Thread %d Directory/File %s\n", omp_get_thread_num(), filenames[i]-&gt;d_name );</pre>

<p>
You should only parallelize the top-level directory.  This means that subdirectories 
</p>
<pre class="code">/tmp/a/1
/tmp/a/2
/tmp/a/3</pre>

<p>
will all be compressed by the same thread.  Let me be more specific to avoid confusion.
The serial implementation calls <em>CompressTree</em> recursively. <strong>DO NOT</strong> parallelize the 
for loop in CompressTree.  (This would be a bad idea, because it would create a new task 
for every directory.  Too many tasks.) Leave <em>compress.c</em> unmodified.
</p>

<p>
In your file <em>parallelcompress.c</em> you will want to do the following:
</p>
<ul>
<li class="level1"><div class="li"> read all the names in the input directory</div>
</li>
<li class="level1"><div class="li"> write a for loop that calls compress tree for every file in that directory</div>
</li>
<li class="level1"><div class="li"> parallelize that for loop</div>
</li>
</ul>

</div>

<h4><a name="you_also_answer_the_following_questions" id="you_also_answer_the_following_questions">You also answer the following questions</a></h4>
<div class="level4">
<ol>
<li class="level1"><div class="li"> This implementation of parallel compression is quite primitive and can exhibit poor parallel performance.  For each of the three factors against parallelism, describe whether this is a problem for this code and why?  For what inputs do these factors arise.  They factors against parallelism are:</div>
<ol>
<li class="level2"><div class="li"> Skew</div>
</li>
<li class="level2"><div class="li"> Startup costs</div>
</li>
<li class="level2"><div class="li"> Interference</div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Why might it be bad idea to create a new thread task for every directory in the hieararchy?  In what situation (for what inputs) would this produce poor parallel performance?  In what situation (for what inputs) would this produce good parallel performance?</div>
</li>
<li class="level1"><div class="li"> Consider a different strategy for parallelizing this code in which a single thread reads the directory hierarchy and creates a list of files to compress and then the files are distributed to many parallel threads for compression.     </div>
<ol>
<li class="level2"><div class="li"> If the serial code used 5% of the time to read the files and 95% of the time to do compression, what is the maximum possible speedup for the parallel code.  (Use Amdahl's law).</div>
</li>
</ol>
</li>
</ol>

</div>

<h3 class="sectionedit2"><a name="what_to_turn_in_and_how" id="what_to_turn_in_and_how">What to turn in and how?</a></h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Submit a file named <strong><em>JHEDid</em>.parallelcompress.c</strong>.  You should replace <em>JHEDid</em> with your JHEDid, for example mine is rburns3.  The file must compile with the following command.</div>
</li>
</ul>
<pre class="code">   gcc -fopenmp rburns3.parallelcompress.c compress.c -lz</pre>
<ul>
<li class="level1"><div class="li"> Submit a <acronym title="Portable Document Format">PDF</acronym> file that contains the answers to the specified questions.</div>
</li>
</ul>

<p>

This should be done via Blackboard.  Turning in assignments and communicating grades are the only things that we will use blackboard for.

</p>

</div>

    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        randal/teach/cs420/openmp.2012.txt · Last modified: 2012/02/10 17:01 by randal      </div>
    </div>

   
    <div class="bar" id="bar__bottom">
      <div class="bar-left" id="bar__bottomleft">
        <form class="button btn_source" method="post" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="edit"><input type="hidden" name="rev" value=""><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Show pagesource" class="button" accesskey="v" title="Show pagesource [V]"></div></form>        <form class="button btn_revs" method="get" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="revisions"><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Old revisions" class="button" accesskey="o" title="Old revisions [O]"></div></form>              </div>
      <div class="bar-right" id="bar__bottomright">
                                <form class="button btn_login" method="get" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="login"><input type="hidden" name="sectok" value="74f8605f2fce7ed554fcc53208f7a6b1"><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Login" class="button" title="Login"></div></form>        <form class="button btn_index" method="get" action="http://hssl.cs.jhu.edu/wiki/doku.php"><div class="no"><input type="hidden" name="do" value="index"><input type="hidden" name="id" value="randal:teach:cs420:openmp.2012"><input type="submit" value="Sitemap" class="button" accesskey="x" title="Sitemap [X]"></div></form>        <a class="nolink" href="http://hssl.cs.jhu.edu/wiki/doku.php?id=randal:teach:cs420:openmp.2012#dokuwiki__top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" title="Back to top"></a>&nbsp;
      </div>
      <div class="clearer"></div>
    </div>

  </div>

  <div class="license">Except where otherwise noted, content on this wiki is licensed under the following license:<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></div>
</div>

<div class="footerinc">

  <a href="http://hssl.cs.jhu.edu/wiki/feed.php" title="Recent changes RSS feed"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-rss.png" width="80" height="15" alt="Recent changes RSS feed"></a>

        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" title="CC Attribution-Noncommercial-Share Alike 3.0 Unported"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/cc-by-nc-sa.png" width="80" height="15" alt=""></a>
  
  <a href="http://www.dokuwiki.org/donate" title="Donate"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-donate.gif" alt="Donate" width="80" height="15"></a>

  <a href="http://www.php.net/" title="Powered by PHP"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-php.gif" width="80" height="15" alt="Powered by PHP"></a>

  <a href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0"></a>

  <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-css.png" width="80" height="15" alt="Valid CSS"></a>

  <a href="http://dokuwiki.org/" title="Driven by DokuWiki"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/button-dw.png" width="80" height="15" alt="Driven by DokuWiki"></a>



</div>

<div class="no"><img src="./randal teach cs420 openmp.2012 [HSSL Wiki]_files/indexer.php" width="1" height="1" alt=""></div>


</body></html>